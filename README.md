# NetDatagramKotlin
network datagram structure written in kotlin

数据流量包基础工具类：封装流量包基础协议以及相关工具使用

一、IPHeader

1.1 IPv4头部是一个复杂的结构，它包含了多个字段，每个字段都有特定的意义。IPv4头部的数据格式如下：

    版本 (Version) - 4位：指定IP协议的版本，IPv4的版本号是4。
    
    头部长度 (IHL, Internet Header Length) - 4位：指定IPv4头部的长度，单位是32位字。最小值是5（即20字节），如果有选项字段，则长度会增加。
    
    服务类型 (Type of Service, TOS) - 8位：指定数据包的服务质量。
    
    总长度 (Total Length) - 16位：指定整个IP数据包的长度，包括头部和数据，单位是字节。
    
    标识 (Identification) - 16位：用于唯一标识主机发送的每一个数据包。
    
    标志 (Flags) - 3位：控制和标识分片。
    
    片偏移 (Fragment Offset) - 13位：用于分片和重组数据包。
    
    生存时间 (Time To Live, TTL) - 8位：指定数据包在网络中可以通过的最大路由器数。
    
    协议 (Protocol) - 8位：指定上层协议，例如TCP是6，UDP是17。
    
    头部校验和 (Header Checksum) - 16位：用于错误检测，只校验头部。
    
    源IP地址 (Source Address) - 32位：发送方的IP地址。
    
    目的IP地址 (Destination Address) - 32位：接收方的IP地址。
    
    选项 (Options) - 可变长度：可选字段，用于网络测试、安全等目的。
    
    填充 (Padding) - 可变长度：确保IP头部长度是32位字的整数倍。

    IPv4头部的结构如下所示（每行代表32位）：
    
     0               8               16              24              31
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |Version|  IHL  |    Type of Service    |        Total Length       |
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |       Identification      |Flags|       Fragment Offset         |
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |   Time to Live   |    Protocol   |        Header Checksum       |
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |                         Source Address                          |
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |                      Destination Address                        |
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |                    Options                    |    Padding    |
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+

1.2 IPv6头部的设计比IPv4更为简化，主要是为了提高路由效率。IPv6头部包含以下字段：

    版本 (Version) - 4位：指定IP协议的版本，IPv6的版本号是6。
    
    流量类别 (Traffic Class) - 8位：类似于IPv4中的服务类型（Type of Service），用于区分数据包的优先级和服务质量。
    
    流标签 (Flow Label) - 20位：用于标识来自同一源的数据包流，以便于特殊处理。
    
    有效载荷长度 (Payload Length) - 16位：指定除了标准40字节的IPv6头部之外的数据包部分的长度，单位是字节。
    
    下一个头部 (Next Header) - 8位：指定紧接着IPv6头部的扩展头部或上层协议的类型，类似于IPv4中的协议字段。
    
    跳限制 (Hop Limit) - 8位：与IPv4中的生存时间（TTL）字段相似，每经过一个路由器该值减一，减至0时数据包被丢弃。
    
    源地址 (Source Address) - 128位：发送方的IPv6地址。
    
    目的地址 (Destination Address) - 128位：接收方的IPv6地址。
    
    IPv6头部的结构如下所示（每行代表32位）：

         0               8               16              24              31
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |Version| Traffic Class |           Flow Label                  |
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |         Payload Length        |  Next Header  |   Hop Limit   |
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |                                                               |
    +                                                               +
    |                                                               |
    +                         Source Address                        +
    |                                                               |
    +                                                               +
    |                                                               |
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |                                                               |
    +                                                               +
    |                                                               |
    +                      Destination Address                      +
    |                                                               |
    +                                                               +
    |                                                               |
    +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
